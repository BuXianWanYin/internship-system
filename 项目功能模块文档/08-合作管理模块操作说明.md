# 合作管理模块操作说明

## 模块概述

合作管理模块用于管理学校与企业的合作关系，包括校企合作申请的提交、审核、合作关系的建立和维护等。

## 一、校企合作申请完整流程

### 1.1 前置条件：企业注册

在提交合作申请之前，企业必须先完成注册：

**企业注册**
- **操作角色**：企业管理员
- **操作说明**：
  - 进入企业注册页面
  - 填写企业基本信息（企业名称、统一社会信用代码、企业地址、联系人、联系电话、邮箱、企业简介等）
  - 提交注册
- **注册结果**：**注册成功后，企业管理员可以立即登录系统，无需等待审核**

**注意**：企业注册成功后即可登录系统，但只有提交并审核通过合作申请后，才能发布实习岗位。

### 1.2 企业提交合作申请

- **操作角色**：企业管理员（已注册并登录）
- **前置条件**：
  - 企业注册成功
  - 企业管理员已登录系统
- **操作接口**：`POST /cooperation/apply`
- **操作说明**：
  1. 登录系统后，进入"合作管理" → "合作申请"页面
  2. 点击"新建申请"按钮
  3. 填写合作申请信息：
     - **企业ID**：自动获取当前登录企业的ID
     - **学校ID**：选择要合作的学校
     - **合作类型**：选择合作类型（如：实习合作、就业合作等）
     - **合作开始时间**：选择合作开始日期
     - **合作结束时间**：选择合作结束日期
     - **合作描述**：详细描述合作内容、合作方式、预期合作规模等
  4. 确认信息无误后，点击"提交申请"
- **状态**：`待审核 (0)`
- **注意事项**：
  - 同一企业不能向同一学校重复提交相同类型的合作申请
  - 如果已有相同类型的合作关系，不能重复申请
  - 合作开始时间不能晚于结束时间

### 1.3 学校审核合作申请

- **操作角色**：系统管理员、学校管理员
- **操作接口**：`POST /cooperation/apply/{applyId}/audit`
- **前置条件**：
  - 合作申请状态为"待审核"
  - 审核人员有相应权限
- **操作说明**：
  1. 进入"合作管理" → "合作申请审核"页面
  2. 查看待审核的合作申请列表
  3. 点击查看申请详情，审核以下内容：
     - 企业资质和基本信息
     - 合作类型是否合理
     - 合作时间是否合理
     - 合作描述是否详细完整
  4. 选择审核结果：
     - **通过**：自动建立合作关系，状态变为"已通过"
     - **拒绝**：拒绝申请，状态变为"已拒绝"，需要填写拒绝原因
  5. 填写审核意见（必填）
  6. 提交审核
- **状态流转**：
  - 通过：`待审核 (0)` → `已通过 (1)`，**同时自动建立合作关系**
  - 拒绝：`待审核 (0)` → `已拒绝 (2)`

### 1.4 自动建立合作关系

- **触发条件**：合作申请审核通过后，系统自动建立合作关系
- **操作说明**：
  - 系统自动创建合作关系记录
  - 合作关系状态为"进行中"
  - 企业可以开始发布实习岗位
  - 学生可以申请该企业的岗位
- **合作关系信息**：
  - 企业ID和学校ID
  - 合作类型
  - 合作开始时间和结束时间
  - 合作描述
  - 合作状态：进行中

**重要提示**：
- **只有建立了合作关系后，企业才能发布实习岗位**
- **只有合作企业的岗位，学生才能看到并申请**
- 合作关系建立后，企业管理员可以在"合作管理" → "合作关系"中查看合作关系详情

## 二、合作关系管理

### 2.1 查看合作关系

- **操作角色**：系统管理员、学校管理员、企业管理员
- **操作说明**：
  1. 进入合作关系列表页面
  2. 查看合作关系详情：
     - 企业信息
     - 合作开始时间
     - 合作状态
     - 合作内容
     - 合作成果

### 2.2 更新合作关系

- **操作角色**：系统管理员、学校管理员
- **操作说明**：
  1. 选择要更新的合作关系
  2. 更新合作信息
  3. 保存更新

### 2.3 终止合作关系

- **操作角色**：系统管理员、学校管理员
- **操作说明**：
  1. 选择要终止的合作关系
  2. 填写终止原因
  3. 确认终止
  4. 状态变为"已终止"
  5. 企业不能再发布新岗位，但已有岗位和申请继续有效

## 三、合作状态说明

| 状态码 | 状态名称 | 说明 |
|--------|---------|------|
| 0 | 待审核 | 合作申请已提交，等待审核 |
| 1 | 已通过 | 合作申请已通过，合作关系已建立 |
| 2 | 已拒绝 | 合作申请被拒绝 |
| 3 | 已终止 | 合作关系已终止 |

## 四、权限说明

### 4.1 企业管理员
- 提交合作申请
- 查看本企业的合作申请状态
- 查看本企业的合作关系信息

### 4.2 系统管理员
- 审核所有合作申请
- 建立、更新、终止所有合作关系
- 查看所有合作关系

### 4.3 学校管理员
- 审核所有合作申请
- 建立、更新、终止所有合作关系
- 查看所有合作关系

## 五、API接口列表

| 接口 | 方法 | 说明 | 权限 |
|------|------|------|------|
| `/cooperation/apply` | POST | 提交合作申请 | 企业管理员 |
| `/cooperation/apply/{applyId}` | GET | 查询申请详情 | 多角色 |
| `/cooperation/apply/page` | GET | 分页查询申请列表 | 多角色 |
| `/cooperation/apply/{applyId}/audit` | POST | 审核申请 | 系统管理员/学校管理员 |
| `/cooperation` | POST | 建立合作关系 | 系统管理员/学校管理员 |
| `/cooperation` | PUT | 更新合作关系 | 系统管理员/学校管理员 |
| `/cooperation/{cooperationId}` | GET | 查询合作关系详情 | 多角色 |
| `/cooperation/page` | GET | 分页查询合作关系列表 | 多角色 |
| `/cooperation/{cooperationId}/terminate` | POST | 终止合作关系 | 系统管理员/学校管理员 |

## 六、常见问题

### Q1: 企业可以多次提交合作申请吗？
A: 可以，但如果之前的申请被拒绝，需要等待一定时间后才能重新提交。

### Q2: 合作关系终止后，已发布的岗位会怎样？
A: 合作关系终止后，企业不能再发布新岗位，但已有岗位和申请继续有效，直到实习结束。

### Q3: 合作申请审核需要多长时间？
A: 一般应在收到申请后7个工作日内完成审核，具体时间由学校规定。

### Q4: 可以修改合作申请吗？
A: 在审核前可以修改，审核后不能修改。

### Q5: 合作关系可以续签吗？
A: 可以，通过更新合作关系信息实现续签。

## 七、合作关系与岗位发布的关系

### 7.1 合作关系的重要性

**合作关系是企业发布岗位的必要条件**：
- 只有建立了合作关系的企业，才能创建和发布实习岗位
- 只有合作企业的岗位，学生才能看到并申请
- 没有合作关系，即使企业创建了岗位，学生也无法看到

### 7.2 完整流程示例

**场景：企业从注册到发布岗位的完整流程**

```
步骤1：企业注册
  企业管理员填写企业信息 → 提交注册 → 注册成功 → 可以立即登录
    ↓
步骤2：企业登录系统
  企业管理员使用账号密码登录
    ↓
步骤3：提交合作申请
  企业管理员填写合作信息 → 提交合作申请
    ↓
步骤5：审核合作申请
  系统管理员/学校管理员审核 → 审核通过 → 自动建立合作关系
    ↓
步骤6：创建岗位
  企业管理员创建岗位草稿 → 填写岗位信息 → 保存
    ↓
步骤7：提交岗位审核
  企业管理员提交岗位审核
    ↓
步骤8：审核岗位
  系统管理员/学校管理员审核 → 审核通过 → 自动发布
    ↓
步骤9：学生可见
  岗位满足所有可见性条件 → 学生可以看到并申请
```

### 7.3 常见问题解答

**Q: 企业注册后，为什么不能发布岗位？**
A: 企业注册成功后可以登录系统，但还不能发布岗位。必须先提交校企合作申请，审核通过后建立合作关系，才能发布岗位。

**Q: 合作申请审核需要多长时间？**
A: 一般应在收到申请后7个工作日内完成审核，具体时间由学校规定。

**Q: 合作关系建立后，企业可以立即发布岗位吗？**
A: 可以。合作关系建立后，企业可以立即创建岗位并提交审核。

**Q: 合作关系终止后，已发布的岗位会怎样？**
A: 合作关系终止后，企业不能再发布新岗位，但已有岗位和申请继续有效，直到实习结束。

## 八、注意事项

1. **申请信息完整性**：合作申请信息要填写完整，包括企业资质、合作意向、合作时间等。
2. **审核及时性**：合作申请应及时审核，避免影响企业发布岗位。
3. **合作关系维护**：建立合作关系后，应定期维护和更新合作信息。
4. **数据权限**：不同角色只能操作权限范围内的数据。
5. **终止处理**：终止合作关系时，要妥善处理已发布的岗位和申请。
6. **前置条件**：企业必须先完成注册，才能提交合作申请。企业注册成功后即可登录，无需审核。
7. **唯一性**：同一企业不能向同一学校重复提交相同类型的合作申请。

