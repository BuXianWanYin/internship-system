# 报表导出功能页面分布设计

## 一、设计原则

**在现有页面添加导出按钮**，基于当前页面的筛选条件导出数据。**只要能看到的页面，基本上都可以添加导出按钮**。

## 二、各角色页面访问权限及导出需求

### 2.1 系统管理员（ROLE_SYSTEM_ADMIN）

**可访问页面及导出需求**：

| 页面路径 | 页面名称 | 导出内容 | 按钮位置 |
|---------|---------|---------|---------|
| **系统管理模块** |
| `/admin/system/school` | 学校管理 | 学校列表数据 | 搜索栏右侧 |
| `/admin/system/college` | 学院管理 | 学院列表数据 | 搜索栏右侧 |
| `/admin/system/major` | 专业管理 | 专业列表数据 | 搜索栏右侧 |
| `/admin/system/class` | 班级管理 | 班级列表数据 | 搜索栏右侧 |
| `/admin/system/semester` | 学期管理 | 学期列表数据 | 搜索栏右侧 |
| `/admin/system/config` | 系统配置 | 配置列表数据（可选） | 搜索栏右侧 |
| `/admin/system/class-teacher` | 班主任任命 | 任命记录数据（可选） | 搜索栏右侧 |
| **用户管理模块** |
| `/admin/user` | 用户管理 | 用户列表数据 | 搜索栏右侧 |
| `/admin/student` | 学生管理 | 学生列表数据、学生个人实习报告 | 搜索栏右侧、表格操作列 |
| `/admin/teacher` | 教师管理 | 教师列表数据 | 搜索栏右侧 |
| `/admin/enterprise` | 企业管理 | 企业列表数据、企业合作情况表 | 搜索栏右侧 |
| `/admin/enterprise-mentor` | 企业导师管理 | 企业导师列表数据 | 搜索栏右侧 |
| **实习管理模块** |
| `/admin/internship/plan` | 实习计划管理 | 实习计划列表数据 | 搜索栏右侧 |
| `/admin/internship/post` | 岗位管理 | 岗位列表数据 | 搜索栏右侧 |
| `/admin/internship/apply/audit` | 实习申请审核 | 实习情况汇总表 | 搜索栏右侧 |
| `/teacher/internship/log` | 实习日志批阅 | 日志列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/weekly-report` | 周报批阅 | 周报列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/achievement` | 成果审核 | 成果列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/feedback` | 问题反馈处理 | 反馈列表数据（可选） | 搜索栏右侧 |
| **评价管理模块** |
| `/teacher/evaluation/student` | 学生评价 | 评价列表数据（可选） | 搜索栏右侧 |

---

### 2.2 学校管理员（ROLE_SCHOOL_ADMIN）

**可访问页面及导出需求**：

| 页面路径 | 页面名称 | 导出内容 | 按钮位置 |
|---------|---------|---------|---------|
| **系统管理模块** |
| `/admin/system/college` | 学院管理 | 本学校的学院列表数据 | 搜索栏右侧 |
| `/admin/system/major` | 专业管理 | 本学校的专业列表数据 | 搜索栏右侧 |
| `/admin/system/class` | 班级管理 | 本学校的班级列表数据 | 搜索栏右侧 |
| `/admin/system/semester` | 学期管理 | 学期列表数据 | 搜索栏右侧 |
| `/admin/system/config` | 系统配置 | 配置列表数据（可选） | 搜索栏右侧 |
| `/admin/system/class-teacher` | 班主任任命 | 本学校的任命记录数据（可选） | 搜索栏右侧 |
| **用户管理模块** |
| `/admin/user` | 用户管理 | 本学校的用户列表数据 | 搜索栏右侧 |
| `/admin/student` | 学生管理 | 本学校的学生列表数据、学生个人实习报告 | 搜索栏右侧、表格操作列 |
| `/admin/teacher` | 教师管理 | 本学校的教师列表数据 | 搜索栏右侧 |
| `/admin/enterprise` | 企业管理 | 合作企业列表数据、企业合作情况表 | 搜索栏右侧 |
| `/admin/enterprise-mentor` | 企业导师管理 | 合作企业的导师列表数据 | 搜索栏右侧 |
| **实习管理模块** |
| `/admin/internship/plan` | 实习计划管理 | 本学校的实习计划列表数据 | 搜索栏右侧 |
| `/admin/internship/post` | 岗位管理 | 合作企业的岗位列表数据 | 搜索栏右侧 |
| `/admin/internship/apply/audit` | 实习申请审核 | 本学校的实习情况汇总表 | 搜索栏右侧 |
| `/teacher/internship/log` | 实习日志批阅 | 本学校的日志列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/weekly-report` | 周报批阅 | 本学校的周报列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/achievement` | 成果审核 | 本学校的成果列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/feedback` | 问题反馈处理 | 本学校的反馈列表数据（可选） | 搜索栏右侧 |
| **评价管理模块** |
| `/teacher/evaluation/student` | 学生评价 | 本学校的评价列表数据（可选） | 搜索栏右侧 |

---

### 2.3 学院负责人（ROLE_COLLEGE_LEADER）

**可访问页面及导出需求**：

| 页面路径 | 页面名称 | 导出内容 | 按钮位置 |
|---------|---------|---------|---------|
| **系统管理模块** |
| `/admin/system/major` | 专业管理 | 本学院的专业列表数据 | 搜索栏右侧 |
| `/admin/system/class` | 班级管理 | 本学院的班级列表数据 | 搜索栏右侧 |
| `/admin/system/class-teacher` | 班主任任命 | 本学院的任命记录数据（可选） | 搜索栏右侧 |
| **用户管理模块** |
| `/admin/user` | 用户管理 | 本学院的用户列表数据 | 搜索栏右侧 |
| `/admin/student` | 学生管理 | 本学院的学生列表数据、学生个人实习报告 | 搜索栏右侧、表格操作列 |
| `/admin/teacher` | 教师管理 | 本学院的教师列表数据 | 搜索栏右侧 |
| `/admin/enterprise` | 企业管理 | 企业列表数据（仅查看，无导出权限） | - |
| `/admin/enterprise-mentor` | 企业导师管理 | 企业导师列表数据 | 搜索栏右侧 |
| **实习管理模块** |
| `/admin/internship/plan` | 实习计划管理 | 本学院的实习计划列表数据 | 搜索栏右侧 |
| `/admin/internship/post` | 岗位管理 | 岗位列表数据 | 搜索栏右侧 |
| `/admin/internship/apply/audit` | 实习申请审核 | 本学院的实习情况汇总表 | 搜索栏右侧 |
| `/teacher/internship/log` | 实习日志批阅 | 本学院的日志列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/weekly-report` | 周报批阅 | 本学院的周报列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/achievement` | 成果审核 | 本学院的成果列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/feedback` | 问题反馈处理 | 本学院的反馈列表数据（可选） | 搜索栏右侧 |
| **评价管理模块** |
| `/teacher/evaluation/student` | 学生评价 | 本学院的评价列表数据（可选） | 搜索栏右侧 |

**注意**：学院负责人**不能**导出企业合作情况表（无权限）

---

### 2.4 班主任（ROLE_CLASS_TEACHER）

**可访问页面及导出需求**：

| 页面路径 | 页面名称 | 导出内容 | 按钮位置 |
|---------|---------|---------|---------|
| **系统管理模块** |
| `/admin/system/class` | 班级管理 | 本班级的数据（仅查看，通常无导出需求） | - |
| **用户管理模块** |
| `/admin/user` | 用户管理 | 本班级的用户列表数据 | 搜索栏右侧 |
| `/admin/student` | 学生管理 | 本班级的学生列表数据、学生个人实习报告 | 搜索栏右侧、表格操作列 |
| **实习管理模块** |
| `/admin/internship/apply/audit` | 实习申请审核 | 本班级的实习情况汇总表 | 搜索栏右侧 |
| `/teacher/internship/log` | 实习日志批阅 | 本班级的日志列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/weekly-report` | 周报批阅 | 本班级的周报列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/achievement` | 成果审核 | 本班级的成果列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/feedback` | 问题反馈处理 | 本班级的反馈列表数据（可选） | 搜索栏右侧 |
| **评价管理模块** |
| `/teacher/evaluation/student` | 学生评价 | 本班级的评价列表数据（可选） | 搜索栏右侧 |

**注意**：班主任**不能**导出企业合作情况表（无权限）

---

### 2.5 企业管理员（ROLE_ENTERPRISE_ADMIN）

**可访问页面及导出需求**：

| 页面路径 | 页面名称 | 导出内容 | 按钮位置 |
|---------|---------|---------|---------|
| **用户管理模块** |
| `/admin/enterprise-mentor` | 企业导师管理 | 本企业的导师列表数据 | 搜索栏右侧 |
| **实习管理模块** |
| `/enterprise/internship/post` | 岗位管理 | 本企业的岗位列表数据 | 搜索栏右侧 |
| `/enterprise/internship/apply` | 申请管理 | 申请列表数据（可选） | 搜索栏右侧 |
| `/enterprise/internship/student` | 实习学生管理 | 学生列表数据、学生个人实习报告 | 搜索栏右侧、表格操作列 |
| `/enterprise/internship/interview` | 面试管理 | 面试列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/log` | 实习日志批阅 | 本企业的日志列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/weekly-report` | 周报批阅 | 本企业的周报列表数据（可选） | 搜索栏右侧 |
| `/enterprise/internship/attendance` | 考勤管理 | 考勤列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/achievement` | 成果审核 | 本企业的成果列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/feedback` | 问题反馈处理 | 本企业的反馈列表数据（可选） | 搜索栏右侧 |
| `/admin/enterprise` | 企业管理（如果可访问） | 本企业的合作情况表 | 搜索栏右侧 |
| **评价管理模块** |
| `/enterprise/evaluation/student` | 学生评价 | 本企业的评价列表数据（可选） | 搜索栏右侧 |

---

### 2.6 企业导师（ROLE_ENTERPRISE_MENTOR）

**可访问页面及导出需求**：

| 页面路径 | 页面名称 | 导出内容 | 按钮位置 |
|---------|---------|---------|---------|
| **实习管理模块** |
| `/enterprise/mentor/student` | 我指导的学生 | 学生列表数据、学生个人实习报告 | 搜索栏右侧、表格操作列 |
| `/teacher/internship/log` | 实习日志批阅 | 分配学生的日志列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/weekly-report` | 周报批阅 | 分配学生的周报列表数据（可选） | 搜索栏右侧 |
| `/enterprise/internship/attendance` | 考勤管理 | 分配学生的考勤列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/achievement` | 成果审核 | 分配学生的成果列表数据（可选） | 搜索栏右侧 |
| `/teacher/internship/feedback` | 问题反馈处理 | 分配学生的反馈列表数据（可选） | 搜索栏右侧 |
| **评价管理模块** |
| `/enterprise/evaluation/student` | 学生评价 | 分配学生的评价列表数据（可选） | 搜索栏右侧 |

---

### 2.7 学生（ROLE_STUDENT）

**可访问页面及导出需求**：

| 页面路径 | 页面名称 | 导出内容 | 按钮位置 |
|---------|---------|---------|---------|
| **实习管理模块** |
| `/student/internship/post` | 岗位列表 | 岗位列表数据（可选，通常不需要） | - |
| `/student/internship/apply` | 实习申请 | 申请列表数据（可选） | 搜索栏右侧 |
| `/student/internship/my` | 我的实习 | 学生个人实习报告 | 实习信息卡片操作区 |
| `/student/internship/interview` | 我的面试 | 面试列表数据（可选） | 搜索栏右侧 |
| `/student/internship/log` | 实习日志 | 个人日志列表数据（可选） | 搜索栏右侧 |
| `/student/internship/weekly-report` | 周报 | 个人周报列表数据（可选） | 搜索栏右侧 |
| `/student/internship/attendance` | 我的考勤 | 个人考勤列表数据（可选） | 搜索栏右侧 |
| `/student/internship/achievement` | 阶段性成果 | 个人成果列表数据（可选） | 搜索栏右侧 |
| `/student/internship/feedback` | 问题反馈 | 个人反馈列表数据（可选） | 搜索栏右侧 |
| **评价管理模块** |
| `/student/evaluation/self` | 自我评价 | 评价数据（可选） | - |
| `/student/evaluation/comprehensive-score` | 综合成绩 | 成绩数据（可选） | - |

---

## 三、重点导出功能详细设计

### 3.1 实习情况汇总表导出

**页面位置**：`/admin/internship/apply/audit` - 实习申请审核页面

**访问角色**：系统管理员、学校管理员、学院负责人、班主任

**按钮位置**：搜索栏右侧

**实现代码**：
```vue
<el-form-item>
  <el-button type="primary" :icon="Search" @click="handleSearch">查询</el-button>
  <el-button :icon="Refresh" @click="handleReset">重置</el-button>
  <el-button 
    type="success" 
    :icon="Download" 
    @click="handleExportInternshipSummary"
    :loading="exportLoading"
  >
    导出Excel
  </el-button>
</el-form-item>
```

**导出参数**：直接使用当前页面的 `searchForm` 筛选条件

---

### 3.2 企业合作情况表导出

**页面位置**：`/admin/enterprise` - 企业管理页面

**访问角色**：系统管理员、学校管理员、企业管理员

**按钮位置**：搜索栏右侧

**实现代码**：
```vue
<el-form-item>
  <el-button type="primary" :icon="Search" @click="handleSearch">查询</el-button>
  <el-button :icon="Refresh" @click="handleReset">重置</el-button>
  <el-button 
    type="success" 
    :icon="Download" 
    @click="handleExportCooperationReport"
    :loading="exportLoading"
    v-if="hasAnyRole(['ROLE_SYSTEM_ADMIN', 'ROLE_SCHOOL_ADMIN', 'ROLE_ENTERPRISE_ADMIN'])"
  >
    导出合作情况表
  </el-button>
</el-form-item>
```

**权限控制**：学院负责人虽然可以访问该页面，但**不能**导出企业合作情况表

---

### 3.3 学生个人实习报告导出

**页面位置**：
1. `/admin/student` - 学生管理页面（管理员端）
2. `/enterprise/internship/student` - 实习学生管理页面（企业端）
3. `/enterprise/mentor/student` - 我指导的学生页面（企业导师端）
4. `/student/internship/my` - 我的实习页面（学生端）

**按钮位置**：
- 管理员/企业端：表格操作列（单个导出）
- 学生端：实习信息卡片操作区

**实现代码**（表格操作列）：
```vue
<el-table-column label="操作" width="200" fixed="right" align="center">
  <template #default="{ row }">
    <el-button 
      link 
      type="primary" 
      size="small" 
      @click="handleView(row)"
    >
      查看
    </el-button>
    <el-button 
      link 
      type="success" 
      size="small" 
      :icon="Download"
      @click="handleExportStudentReport(row)"
      v-if="row.currentApplyId"
    >
      导出报告
    </el-button>
  </template>
</el-table-column>
```

**实现代码**（学生端）：
```vue
<el-card v-if="currentApply">
  <template #header>
    <div class="card-header">
      <span>我的实习</span>
      <el-button 
        type="primary" 
        :icon="Download" 
        @click="handleExportMyReport"
        :loading="exportLoading"
      >
        导出实习报告
      </el-button>
    </div>
  </template>
  <!-- 实习信息内容 -->
</el-card>
```

---

### 3.4 系统管理模块导出（系统管理员）

**页面位置**：
- `/admin/system/school` - 学校管理
- `/admin/system/college` - 学院管理
- `/admin/system/major` - 专业管理
- `/admin/system/class` - 班级管理
- `/admin/system/semester` - 学期管理

**导出内容**：各管理页面的列表数据

**按钮位置**：搜索栏右侧

**实现代码**：
```vue
<el-form-item>
  <el-button type="primary" :icon="Search" @click="handleSearch">查询</el-button>
  <el-button :icon="Refresh" @click="handleReset">重置</el-button>
  <el-button 
    type="success" 
    :icon="Download" 
    @click="handleExport"
    :loading="exportLoading"
  >
    导出Excel
  </el-button>
</el-form-item>
```

---

### 3.5 用户管理模块导出

**页面位置**：
- `/admin/user` - 用户管理
- `/admin/student` - 学生管理
- `/admin/teacher` - 教师管理
- `/admin/enterprise` - 企业管理
- `/admin/enterprise-mentor` - 企业导师管理

**导出内容**：各管理页面的列表数据

**按钮位置**：搜索栏右侧

**实现代码**：同上

---

### 3.6 实习管理模块导出

**页面位置**：
- `/admin/internship/plan` - 实习计划管理
- `/admin/internship/post` - 岗位管理
- `/enterprise/internship/post` - 岗位管理（企业端）
- `/enterprise/internship/apply` - 申请管理
- `/enterprise/internship/interview` - 面试管理
- 其他过程记录页面（日志、周报、成果、反馈等）

**导出内容**：各管理页面的列表数据

**按钮位置**：搜索栏右侧

**实现代码**：同上

---

## 四、导出功能实现规范

### 4.1 通用导出工具函数

创建 `internship-web/src/utils/exportUtils.js`：

```javascript
import { ElMessage } from 'element-plus'

/**
 * 导出Excel文件
 * @param {Function} apiFunction - API函数
 * @param {Object} params - 导出参数
 * @param {String} filename - 文件名（不含扩展名）
 * @returns {Promise<Boolean>}
 */
export async function exportExcel(apiFunction, params, filename) {
  try {
    const response = await apiFunction(params)
    
    // 创建Blob对象
    const blob = new Blob([response.data], {
      type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
    })
    
    // 创建下载链接
    const url = window.URL.createObjectURL(blob)
    const link = document.createElement('a')
    link.href = url
    link.download = `${filename || '导出数据'}_${formatDate(new Date(), 'yyyyMMdd_HHmmss')}.xlsx`
    
    // 触发下载
    document.body.appendChild(link)
    link.click()
    
    // 清理
    document.body.removeChild(link)
    window.URL.revokeObjectURL(url)
    
    return true
  } catch (error) {
    console.error('导出失败:', error)
    ElMessage.error(error.response?.data?.message || '导出失败，请稍后重试')
    throw error
  }
}

/**
 * 格式化日期
 */
function formatDate(date, format) {
  const year = date.getFullYear()
  const month = String(date.getMonth() + 1).padStart(2, '0')
  const day = String(date.getDate()).padStart(2, '0')
  const hours = String(date.getHours()).padStart(2, '0')
  const minutes = String(date.getMinutes()).padStart(2, '0')
  const seconds = String(date.getSeconds()).padStart(2, '0')
  
  return format
    .replace('yyyy', year)
    .replace('MM', month)
    .replace('dd', day)
    .replace('HH', hours)
    .replace('mm', minutes)
    .replace('ss', seconds)
}
```

### 4.2 页面中使用示例

```javascript
import { ref } from 'vue'
import { ElMessage } from 'element-plus'
import { Download } from '@element-plus/icons-vue'
import { exportExcel } from '@/utils/exportUtils'
import { reportApi } from '@/api/report'

const exportLoading = ref(false)

// 导出实习情况汇总表
const handleExportInternshipSummary = async () => {
  exportLoading.value = true
  try {
    await exportExcel(
      reportApi.exportInternshipSummaryReport,
      searchForm,  // 使用当前页面的筛选条件
      '实习情况汇总表'
    )
    ElMessage.success('导出成功')
  } catch (error) {
    // 错误已在 exportExcel 中处理
  } finally {
    exportLoading.value = false
  }
}

// 导出学生个人实习报告
const handleExportStudentReport = async (row) => {
  if (!row.currentApplyId) {
    ElMessage.warning('该学生暂无实习申请')
    return
  }
  
  exportLoading.value = true
  try {
    await exportExcel(
      () => reportApi.exportStudentInternshipReport(row.currentApplyId),
      {},
      `学生实习报告_${row.studentNo}_${row.studentName}`
    )
    ElMessage.success('导出成功')
  } catch (error) {
    // 错误已在 exportExcel 中处理
  } finally {
    exportLoading.value = false
  }
}

// 导出列表数据（通用）
const handleExport = async () => {
  exportLoading.value = true
  try {
    await exportExcel(
      listApi.exportList,  // 对应的导出API
      searchForm,  // 使用当前页面的筛选条件
      '导出数据'
    )
    ElMessage.success('导出成功')
  } catch (error) {
    // 错误已在 exportExcel 中处理
  } finally {
    exportLoading.value = false
  }
}
```

---

## 五、权限控制总结

### 5.1 各报表类型的导出权限

| 报表类型 | 可导出角色 |
|---------|-----------|
| 实习情况汇总表 | 系统管理员、学校管理员、学院负责人、班主任 |
| 企业合作情况表 | 系统管理员、学校管理员、企业管理员 |
| 学生个人实习报告 | 所有角色（但数据范围不同） |
| 各类管理页面列表数据 | 所有能访问该页面的角色 |

### 5.2 数据权限范围

| 角色 | 实习情况汇总表 | 企业合作情况表 | 学生个人实习报告 | 管理页面列表数据 |
|-----|--------------|--------------|----------------|----------------|
| 系统管理员 | 全部数据 | 全部数据 | 全部数据 | 全部数据 |
| 学校管理员 | 本学校 | 合作企业 | 本学校学生 | 本学校数据 |
| 学院负责人 | 本学院 | ❌ 无权限 | 本学院学生 | 本学院数据 |
| 班主任 | 本班级 | ❌ 无权限 | 本班级学生 | 本班级数据 |
| 企业管理员 | ❌ 无权限 | 本企业 | 本企业学生 | 本企业数据 |
| 企业导师 | ❌ 无权限 | ❌ 无权限 | 分配的学生 | 分配学生的数据 |
| 学生 | ❌ 无权限 | ❌ 无权限 | 本人 | 个人数据 |

---

## 六、实施清单

### 6.1 优先级高的页面（必须实现）

1. ✅ `internship-web/src/views/admin/InternshipApplyAudit.vue`
   - 添加：实习情况汇总表导出按钮

2. ✅ `internship-web/src/views/admin/EnterpriseManagement.vue`
   - 添加：企业合作情况表导出按钮（带权限控制）

3. ✅ `internship-web/src/views/admin/StudentManagement.vue`
   - 添加：学生列表导出、学生个人实习报告导出

4. ✅ `internship-web/src/views/enterprise/StudentManagement.vue`
   - 添加：学生列表导出、学生个人实习报告导出

5. ✅ `internship-web/src/views/enterprise/MentorStudentManagement.vue`
   - 添加：学生列表导出、学生个人实习报告导出

6. ✅ `internship-web/src/views/student/MyInternship.vue`
   - 添加：学生个人实习报告导出按钮

### 6.2 系统管理模块（系统管理员）

7. ✅ `internship-web/src/views/admin/SchoolManagement.vue`
   - 添加：学校列表导出按钮

8. ✅ `internship-web/src/views/admin/CollegeManagement.vue`
   - 添加：学院列表导出按钮

9. ✅ `internship-web/src/views/admin/MajorManagement.vue`
   - 添加：专业列表导出按钮

10. ✅ `internship-web/src/views/admin/ClassManagement.vue`
    - 添加：班级列表导出按钮

11. ✅ `internship-web/src/views/admin/SemesterManagement.vue`
    - 添加：学期列表导出按钮

### 6.3 用户管理模块

12. ✅ `internship-web/src/views/admin/UserManagement.vue`
    - 添加：用户列表导出按钮

13. ✅ `internship-web/src/views/admin/TeacherManagement.vue`
    - 添加：教师列表导出按钮

14. ✅ `internship-web/src/views/admin/EnterpriseMentorManagement.vue`
    - 添加：企业导师列表导出按钮

### 6.4 实习管理模块

15. ✅ `internship-web/src/views/admin/InternshipPlanManagement.vue`
    - 添加：实习计划列表导出按钮

16. ✅ `internship-web/src/views/enterprise/InternshipPostManagement.vue`
    - 添加：岗位列表导出按钮

17. ✅ `internship-web/src/views/enterprise/ApplicationManagement.vue`
    - 添加：申请列表导出按钮（可选）

18. ✅ `internship-web/src/views/enterprise/InterviewManagement.vue`
    - 添加：面试列表导出按钮（可选）

### 6.5 需要创建的工具文件

1. ✅ `internship-web/src/utils/exportUtils.js`
   - 创建：通用导出工具函数

### 6.6 后端接口（需要实现）

1. ✅ 实习情况汇总表导出接口
2. ✅ 企业合作情况表导出接口
3. ✅ 学生个人实习报告导出接口
4. ✅ 各类管理页面的列表数据导出接口（根据实际需求实现）

---

## 七、注意事项

1. **权限验证**：前端按钮显示需要权限控制，但后端接口也必须进行权限验证
2. **数据过滤**：后端必须根据用户角色自动过滤数据，确保数据安全
3. **空数据处理**：当筛选条件无数据时，应提示用户，而不是导出空文件
4. **文件名规范**：导出文件名应包含报表类型、时间戳等信息，便于识别
5. **加载状态**：导出过程中应显示加载状态，防止重复点击
6. **错误处理**：导出失败时应显示友好的错误提示
7. **可选导出**：标记为"可选"的导出功能，可根据实际需求决定是否实现

---

**文档版本**：v2.0  
**创建日期**：2024年  
**最后更新**：2024年
