# 第四阶段：实习过程跟踪模块 - 数据库设计完成报告

## 一、数据库表创建情况

### ✅ 已创建的表（共9张）

1. **internship_plan** - 实习计划表
2. **internship_post** - 实习岗位表
3. **internship_apply** - 实习申请表
4. **interview** - 面试表
5. **internship_log** - 实习日志表
6. **internship_weekly_report** - 周报表
7. **attendance** - 考勤表
8. **internship_achievement** - 阶段性成果表
9. **internship_feedback** - 问题反馈表

## 二、表结构验证

所有表结构已通过验证，符合设计规范：
- ✅ 字符集：utf8mb4
- ✅ 排序规则：utf8mb4_unicode_ci
- ✅ 存储引擎：InnoDB
- ✅ 软删除字段：delete_flag
- ✅ 时间字段：create_time、update_time（自动更新）
- ✅ 索引：主键索引、唯一索引、普通索引已创建

## 三、测试数据插入情况

### ✅ 已插入的测试数据

1. **实习计划**：1条
   - 计划名称：2024年春季生产实习计划
   - 计划编号：PLAN2024001
   - 状态：已发布（4）

2. **实习岗位**：1条
   - 岗位名称：Java开发实习生
   - 岗位编号：POST001
   - 企业ID：1
   - 状态：已发布（3）

3. **实习申请**：1条
   - 学生ID：1
   - 申请类型：合作企业（1）
   - 企业ID：1
   - 岗位ID：1
   - 状态：已通过（1）

## 四、表关系说明

### 4.1 主要关联关系

1. **internship_plan** 关联：
   - semester_info（学期表）
   - school_info（学校表）
   - college_info（学院表，可选）
   - major_info（专业表，可选）

2. **internship_post** 关联：
   - enterprise_info（企业表）

3. **internship_apply** 关联：
   - student_info（学生表）
   - user_info（用户表）
   - enterprise_info（企业表，可选）
   - internship_post（岗位表，可选）

4. **interview** 关联：
   - internship_apply（申请表）
   - enterprise_info（企业表）
   - student_info（学生表）

5. **internship_log** 关联：
   - student_info（学生表）
   - user_info（用户表）
   - internship_apply（申请表）
   - teacher_info（教师表，指导教师）

6. **internship_weekly_report** 关联：
   - student_info（学生表）
   - user_info（用户表）
   - internship_apply（申请表）
   - teacher_info（教师表，指导教师）

7. **attendance** 关联：
   - student_info（学生表）
   - user_info（用户表）
   - internship_apply（申请表）
   - user_info（用户表，确认人）

8. **internship_achievement** 关联：
   - student_info（学生表）
   - user_info（用户表）
   - internship_apply（申请表）
   - teacher_info（教师表，指导教师）

9. **internship_feedback** 关联：
   - student_info（学生表）
   - user_info（用户表）
   - internship_apply（申请表）
   - user_info（用户表，回复人）

## 五、数据权限说明

### 5.1 数据权限过滤规则

所有查询接口在Service层实现数据权限过滤：

- **系统管理员**：可查看所有数据
- **学校管理员**：只能查看本校的数据
- **学院负责人**：只能查看本院的数据
- **班主任**：只能查看本班学生的数据
- **指导教师**：只能查看分配的学生数据
- **企业管理员**：只能查看本企业的岗位和申请数据
- **企业导师**：只能查看本企业的实习生数据
- **学生**：只能查看个人数据

### 5.2 特殊业务规则

1. **岗位查询**：
   - 学生端只能查看与所属学校有合作关系的企业的岗位
   - 通过`enterprise_school_cooperation`表过滤

2. **申请提交**：
   - 学生只能向与所属学校有合作关系的企业投递简历
   - 学生只能投递状态为"已发布"的岗位

3. **自主实习**：
   - 需要班主任或学校管理员审核
   - 审核通过后才能继续实习流程

## 六、下一步开发建议

### 6.1 后端开发顺序

1. **实习计划管理**（InternshipPlan）
   - 创建实体类、Mapper、Service、Controller
   - 实现CRUD操作
   - 实现审核流程
   - 实现数据权限过滤

2. **岗位管理**（InternshipPost）
   - 创建实体类、Mapper、Service、Controller
   - 实现CRUD操作
   - 实现审核流程
   - 实现数据权限过滤（学生端只显示合作企业岗位）

3. **实习申请管理**（InternshipApply）
   - 创建实体类、Mapper、Service、Controller
   - 实现两种申请方式（合作企业、自主实习）
   - 实现审核流程
   - 实现简历投递限制验证

4. **面试管理**（Interview）
   - 创建实体类、Mapper、Service、Controller
   - 实现面试安排、确认、结果提交

5. **过程记录功能**
   - 实习日志（InternshipLog）
   - 周报（InternshipWeeklyReport）
   - 考勤（Attendance）
   - 阶段性成果（InternshipAchievement）
   - 问题反馈（InternshipFeedback）

### 6.2 前端开发顺序

1. **实习计划管理页面**
2. **岗位管理页面**（企业端、学生端）
3. **实习申请页面**（学生端）
4. **申请审核页面**（管理员端）
5. **面试管理页面**（企业端、学生端）
6. **过程记录页面**（学生端、教师端、企业端）

## 七、注意事项

1. **数据权限过滤**：所有查询接口必须在Service层实现数据权限过滤
2. **业务逻辑验证**：申请岗位前必须验证企业合作关系和岗位状态
3. **状态流转**：注意各表的状态字段和状态流转逻辑
4. **富文本内容**：日志、周报、反馈等字段支持富文本，前端需要使用富文本编辑器
5. **文件上传**：附件字段存储URL，需要实现文件上传功能
6. **时间字段**：注意日期和时间的处理，前端需要格式化显示

## 八、数据库表清单

| 表名 | 说明 | 状态 |
|------|------|------|
| internship_plan | 实习计划表 | ✅ 已创建 |
| internship_post | 实习岗位表 | ✅ 已创建 |
| internship_apply | 实习申请表 | ✅ 已创建 |
| interview | 面试表 | ✅ 已创建 |
| internship_log | 实习日志表 | ✅ 已创建 |
| internship_weekly_report | 周报表 | ✅ 已创建 |
| attendance | 考勤表 | ✅ 已创建 |
| internship_achievement | 阶段性成果表 | ✅ 已创建 |
| internship_feedback | 问题反馈表 | ✅ 已创建 |

## 九、总结

✅ **数据库设计完成**：9张表全部创建成功
✅ **表结构验证通过**：所有字段、索引、约束正确
✅ **测试数据已插入**：基础测试数据已准备
✅ **文档已生成**：数据库设计文档、接口设计文档已创建

**下一步**：可以开始后端实体类、Mapper、Service、Controller的开发。

