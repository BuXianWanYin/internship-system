# 动态菜单使用说明

## 一、已完成的修改

### 1. 创建菜单配置文件
- 文件位置：`internship-web/src/config/menu.config.js`
- 功能：集中管理所有菜单项和角色权限

### 2. 更新 MainLayout 组件
- 文件位置：`internship-web/src/components/common/MainLayout.vue`
- 修改内容：
  - 使用 `filterMenuByRoles` 函数动态生成菜单
  - 移除了硬编码的菜单项
  - 使用 `v-for` 动态渲染菜单

## 二、使用方法

### 添加新菜单项

在 `menu.config.js` 中的 `menuItems` 数组中添加新菜单项：

```javascript
{
  index: '/your/route/path',  // 路由路径
  title: '菜单标题',           // 显示标题
  icon: YourIcon,              // Element Plus 图标组件
  roles: ['ROLE_XXX'],         // 可见的角色列表，['*'] 表示所有角色
  children: [                  // 可选：子菜单
    // 子菜单项...
  ]
}
```

### 修改菜单权限

直接修改菜单项的 `roles` 数组即可：

```javascript
{
  index: '/admin/system/school',
  title: '学校管理',
  icon: School,
  roles: ['ROLE_SYSTEM_ADMIN', 'ROLE_NEW_ROLE']  // 添加新角色
}
```

### 动态标题（根据角色显示不同标题）

使用 `titleMap` 属性：

```javascript
{
  index: '/admin/enterprise',
  title: '企业管理',
  icon: OfficeBuilding,
  roles: ['ROLE_SYSTEM_ADMIN', 'ROLE_SCHOOL_ADMIN'],
  titleMap: {
    'ROLE_SYSTEM_ADMIN': '企业管理',
    'ROLE_SCHOOL_ADMIN': '合作企业管理'
  }
}
```

## 三、各角色菜单预览

### 系统管理员 (ROLE_SYSTEM_ADMIN)
- 首页
- 系统管理（全部子菜单）
- 用户管理（全部子菜单）
- 实习管理（管理员）

### 学校管理员 (ROLE_SYSTEM_ADMIN)
- 首页
- 系统管理（学院、专业、班级、学期、配置）
- 用户管理（用户、教师、合作企业管理、企业导师详情）
- 实习管理（管理员）

### 学院领导 (ROLE_COLLEGE_LEADER)
- 首页
- 系统管理（专业、班级、班主任任命）
- 用户管理（用户、教师）
- 实习管理（教师）

### 班主任 (ROLE_CLASS_TEACHER)
- 首页
- 系统管理（班级管理）
- 用户管理（用户、学生）
- 实习管理（管理员 + 教师）

### 指导教师 (ROLE_INSTRUCTOR)
- 首页
- 实习管理（教师）

### 企业管理员 (ROLE_ENTERPRISE_ADMIN)
- 首页
- 企业管理（企业导师管理）
- 实习管理（企业）

### 企业导师 (ROLE_ENTERPRISE_MENTOR)
- 首页
- 实习管理（企业 + 教师）

### 学生 (ROLE_STUDENT)
- 首页
- 实习管理（学生）

## 四、测试步骤

1. **启动项目**
   ```bash
   cd internship-web
   npm run dev
   ```

2. **测试不同角色**
   - 使用不同角色的账号登录
   - 检查菜单是否正确显示
   - 验证菜单项是否与角色权限匹配

3. **测试动态标题**
   - 使用系统管理员登录，查看"企业管理"菜单
   - 使用学校管理员登录，查看"合作企业管理"菜单
   - 验证标题是否正确显示

## 五、注意事项

1. **路由权限**：菜单显示只是UI层面的控制，后端路由守卫仍然需要验证权限
2. **图标导入**：新菜单项需要从 `@element-plus/icons-vue` 导入图标组件
3. **路由配置**：确保菜单项的 `index` 与路由配置中的 `path` 一致
4. **角色名称**：角色名称必须与后端返回的角色名称完全一致（包括 `ROLE_` 前缀）

## 六、常见问题

### Q: 菜单不显示？
A: 检查以下几点：
- 用户角色是否正确获取（查看 `authStore.roles`）
- 菜单项的 `roles` 数组是否包含用户角色
- 浏览器控制台是否有错误信息

### Q: 菜单重复显示？
A: 确保同一路由路径的菜单项只配置一次，使用 `titleMap` 处理不同角色的标题差异

### Q: 子菜单不显示？
A: 检查父菜单和子菜单的 `roles` 配置，确保用户角色在两者中都存在

## 七、扩展功能

### 添加菜单排序
在菜单配置中添加 `order` 属性，然后在 `filterMenuByRoles` 函数中排序：

```javascript
{
  index: '/dashboard',
  title: '首页',
  icon: House,
  roles: ['*'],
  order: 0  // 排序值，越小越靠前
}
```

### 添加菜单徽章
可以在菜单配置中添加 `badge` 属性，然后在渲染时显示：

```javascript
{
  index: '/admin/internship/apply/audit',
  title: '实习申请审核',
  icon: DocumentChecked,
  roles: ['ROLE_SYSTEM_ADMIN'],
  badge: 5  // 显示数字徽章
}
```

